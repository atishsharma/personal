<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMEGP Project Report - Cordyceps Mushroom</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Times New Roman for that official document feel */
        @import url('https://fonts.googleapis.com/css2?family=Tinos:wght@400;700&display=swap');

        :root {
            --paper-width: 210mm;
            --paper-height: 297mm;
        }

        body {
            background-color: #525659;
            /* Adobe Reader background feel */
            font-family: 'Times New Roman', Times, serif;
            color: #000;
            margin: 0;
            padding: 0;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        /* --- Control Panel (UI Only) --- */
        .control-panel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #f0f0f0;
            border-bottom: 1px solid #ccc;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            font-family: sans-serif;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: 1px solid #999;
            cursor: pointer;
            font-size: 13px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            background: white;
            transition: all 0.2s;
        }

        .btn:hover {
            background-color: #e0e0e0;
        }

        .btn-primary {
            background-color: #0056b3;
            color: white;
            border-color: #004494;
        }

        .btn-primary:hover {
            background-color: #004494;
        }

        /* --- Paper/Page Styling --- */
        .paper-container {
            padding-top: 70px;
            padding-bottom: 50px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .paper {
            background: white;
            width: var(--paper-width);
            min-height: var(--paper-height);
            padding: 25mm 20mm;
            /* Standard Word Doc Margins */
            box-sizing: border-box;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        /* --- Report Content Styling --- */
        h1 {
            font-size: 24px;
            text-align: center;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-decoration: underline;
            font-weight: bold;
        }

        h2 {
            font-size: 16px;
            text-align: center;
            font-weight: normal;
            margin-top: 0;
            margin-bottom: 30px;
            color: #333;
        }

        h3.section-title {
            font-size: 16px;
            border-bottom: 1px solid #000;
            padding-bottom: 5px;
            margin-top: 25px;
            margin-bottom: 15px;
            text-transform: uppercase;
            font-weight: bold;
            background-color: #f5f5f5;
            /* Subtle shading for headers */
            padding-left: 5px;
        }

        p {
            font-size: 14px;
            line-height: 1.5;
            text-align: justify;
            margin-bottom: 10px;
        }

        /* --- Table Styling (Strict Document Style) --- */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 14px;
            border: 1px solid #000;
        }

        th,
        td {
            border: 1px solid #000;
            /* Solid borders for print */
            padding: 8px 10px;
            text-align: left;
            vertical-align: middle;
        }

        th {
            background-color: #e0e0e0 !important;
            /* Visible gray in print */
            font-weight: bold;
            text-align: center;
        }

        td.amount-col {
            text-align: right;
            width: 120px;
            font-family: 'Times New Roman', serif;
            /* Keep font consistent */
        }

        td.label-col {
            background-color: #fafafa;
            font-weight: bold;
            width: 40%;
        }

        tr.total-row td {
            font-weight: bold;
            background-color: #f0f0f0;
            border-top: 2px double #000;
            /* Double line for totals */
        }

        /* --- Editable Fields --- */
        .editable {
            color: #000;
            border-bottom: 1px dotted #999;
            /* Subtle guide for screen */
            padding: 0 2px;
            display: inline-block;
            min-width: 20px;
        }

        .editable:hover {
            background-color: #ffffcc;
            cursor: text;
        }

        .editable:focus {
            outline: none;
            background-color: #e6f7ff;
            border-bottom: 1px solid blue;
        }

        /* --- Footer/Signature --- */
        .signature-section {
            margin-top: 60px;
            display: flex;
            justify-content: space-between;
            page-break-inside: avoid;
        }

        .signature-box {
            width: 200px;
            text-align: center;
        }

        .signature-line {
            border-top: 1px solid #000;
            margin-top: 40px;
            padding-top: 5px;
            font-weight: bold;
        }

        .currency::before {
            content: "₹ ";
        }

        /* --- PRINT SPECIFIC STYLES (Fixes Blank Pages) --- */
        @media print {
            @page {
                size: A4;
                margin: 1.5cm;
                /* Safe margin */
            }

            body {
                background: white;
                font-size: 12pt;
                -webkit-print-color-adjust: exact;
            }

            .control-panel,
            .no-print {
                display: none !important;
            }

            .paper-container {
                margin: 0;
                padding: 0;
                display: block;
            }

            .paper {
                box-shadow: none;
                margin: 0;
                padding: 0;
                width: 100%;
                /* CRITICAL FIX: Allow height to adapt, prevents forced page breaks */
                min-height: 0;
                height: auto;
                border: none;
                page-break-after: always;
            }

            .paper:last-child {
                page-break-after: auto;
            }

            /* Remove editable cues for print */
            .editable {
                border-bottom: none;
                background: transparent !important;
            }

            table {
                page-break-inside: auto;
            }

            tr {
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>

    <!-- Control Panel -->
    <div class="control-panel no-print">
        <div>
            <strong>PMEGP Report Generator</strong>
        </div>
        <div style="display: flex; gap: 10px;">
            <button onclick="calculateTotals()" class="btn">
                <i class="fas fa-calculator"></i> Recalculate
            </button>
            <button onclick="window.print()" class="btn btn-primary">
                <i class="fas fa-file-pdf"></i> Download PDF
            </button>
        </div>
    </div>

    <div class="paper-container">

        <!-- PAGE 1 -->
        <div class="paper">
            <h1>Detailed Project Report (DPR)</h1>
            <h2>For PMEGP Loan Application</h2>

            <div
                style="text-align: center; margin-bottom: 20px; border: 1px solid #000; padding: 10px; width: 80%; margin-left: auto; margin-right: auto;">
                <strong>Activity:</strong> <span class="editable" contenteditable="true">Cordyceps Militaris Mushroom
                    Cultivation</span>
            </div>

            <h3 class="section-title">1. Applicant Profile</h3>
            <table>
                <tr>
                    <td class="label-col">Name of Applicant</td>
                    <td><span class="editable" contenteditable="true">Mrs. Anjali Sharma</span></td>
                </tr>
                <tr>
                    <td class="label-col">Age / Gender</td>
                    <td><span class="editable" contenteditable="true">38 Years / Female</span></td>
                </tr>
                <tr>
                    <td class="label-col">Category</td>
                    <td><span class="editable" contenteditable="true">General (Women Entrepreneur)</span></td>
                </tr>
                <tr>
                    <td class="label-col">Address (Site)</td>
                    <td><span class="editable" contenteditable="true">House No. 123, Green Valley, Dehradun,
                            Uttarakhand</span></td>
                </tr>
                <tr>
                    <td class="label-col">Contact Number</td>
                    <td><span class="editable" contenteditable="true">+91 98765 43210</span></td>
                </tr>
                <tr>
                    <td class="label-col">Legal Status</td>
                    <td>Proprietorship</td>
                </tr>
                <tr>
                    <td class="label-col">GSTIN</td>
                    <td><span class="editable" contenteditable="true">05AAAAA0000A1Z5</span></td>
                </tr>
            </table>

            <h3 class="section-title">2. Project Introduction</h3>
            <p><span class="editable" contenteditable="true">This project proposal is for the establishment of a
                    semi-commercial cultivation unit for <strong>Cordyceps Militaris</strong>, a high-value medicinal
                    mushroom. The unit will be setup in a controlled environment within the applicant's existing
                    residence (20ft x 10ft dedicated space), which eliminates the need for rental infrastructure and
                    ensures low overheads.</span></p>
            <p><span class="editable" contenteditable="true">The project is initiated by a Woman Entrepreneur, supported
                    by her family members (Husband and Son). The business is registered under GST and aims to produce
                    dried fruit bodies for the domestic nutraceutical market.</span></p>

            <h3 class="section-title">3. Infrastructure & Capabilities</h3>
            <table>
                <tr>
                    <td class="label-col">Available Area</td>
                    <td><span class="editable" contenteditable="true">200 Sq. Ft (Residential Premises)</span></td>
                </tr>
                <tr>
                    <td class="label-col">Manpower</td>
                    <td><span class="editable" contenteditable="true">3 Persons (Self + 2 Family Members)</span></td>
                </tr>
                <tr>
                    <td class="label-col">Power Connection</td>
                    <td><span class="editable" contenteditable="true">3 KW Domestic + 7.5 KVA Diesel Generator</span>
                    </td>
                </tr>
            </table>
        </div>

        <!-- PAGE 2 -->
        <div class="paper">
            <h3 class="section-title" style="margin-top: 0;">4. Capital Expenditure (Project Cost)</h3>

            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;">S.No</th>
                        <th>Particulars of Asset</th>
                        <th class="amount-col">Amount (₹)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: center;">1</td>
                        <td><span class="editable" contenteditable="true">Insulation & Lab Renovation (PUF
                                Panels)</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">60000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">2</td>
                        <td><span class="editable" contenteditable="true">Heavy Duty Steel Racks & Growing Trays</span>
                        </td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">50000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">3</td>
                        <td><span class="editable" contenteditable="true">Air Conditioner (1.5 Ton Inverter)</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">45000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">4</td>
                        <td><span class="editable" contenteditable="true">Laminar Air Flow (LAF) Cabinet</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">65000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">5</td>
                        <td><span class="editable" contenteditable="true">Vertical Autoclave (Sterilizer)</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">45000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">6</td>
                        <td><span class="editable" contenteditable="true"><strong>Power Generator (7.5
                                    KVA)</strong></span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">85000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">7</td>
                        <td><span class="editable" contenteditable="true">Humidifiers, HEPA Filters, Sensors</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">25000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">8</td>
                        <td><span class="editable" contenteditable="true">Glass Jars (1000 pcs) & PP Bags</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">30000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">9</td>
                        <td><span class="editable" contenteditable="true">Dehydrator & Packaging Tools</span></td>
                        <td class="amount-col currency"><span class="editable cost-item"
                                contenteditable="true">25000</span></td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="2" style="text-align: right;">Total Fixed Capital (A)</td>
                        <td class="amount-col currency" id="totalCapex">430000</td>
                    </tr>
                </tbody>
            </table>

            <h3 class="section-title">5. Working Capital (1st Cycle)</h3>
            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;">S.No</th>
                        <th>Particulars</th>
                        <th class="amount-col">Amount (₹)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: center;">1</td>
                        <td><span class="editable" contenteditable="true">Raw Materials (Brown Rice, Chemicals)</span>
                        </td>
                        <td class="amount-col currency"><span class="editable wc-item"
                                contenteditable="true">30000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">2</td>
                        <td><span class="editable" contenteditable="true">Mother Culture & Liquid Spawn</span></td>
                        <td class="amount-col currency"><span class="editable wc-item"
                                contenteditable="true">15000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">3</td>
                        <td><span class="editable" contenteditable="true">Electricity & Generator Fuel</span></td>
                        <td class="amount-col currency"><span class="editable wc-item"
                                contenteditable="true">25000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">4</td>
                        <td><span class="editable" contenteditable="true">Staff Salary (Stipend for Family Labor)</span>
                        </td>
                        <td class="amount-col currency"><span class="editable wc-item"
                                contenteditable="true">80000</span></td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">5</td>
                        <td><span class="editable" contenteditable="true">Packaging & Marketing Contingency</span></td>
                        <td class="amount-col currency"><span class="editable wc-item"
                                contenteditable="true">20000</span></td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="2" style="text-align: right;">Total Working Capital (B)</td>
                        <td class="amount-col currency" id="totalWC">170000</td>
                    </tr>
                </tbody>
            </table>

            <div
                style="border: 2px solid #000; padding: 10px; margin-top: 20px; text-align: center; background-color: #f9f9f9;">
                <strong>TOTAL PROJECT COST (A + B):</strong>
                <span class="currency" style="font-weight: bold; font-size: 18px;" id="grandTotal">600000</span>
                <br>
                <span style="font-size: 12px; font-style: italic;">(Rupees Six Lakh Only)</span>
            </div>
        </div>

        <!-- PAGE 3 -->
        <div class="paper">
            <h3 class="section-title" style="margin-top: 0;">6. Means of Finance</h3>

            <table>
                <thead>
                    <tr>
                        <th>Source</th>
                        <th style="width: 100px; text-align: center;">% Share</th>
                        <th class="amount-col">Amount (₹)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Own Contribution</strong> (Promoter)</td>
                        <td style="text-align: center;">5%</td>
                        <td class="amount-col currency" id="ownContribution">30000</td>
                    </tr>
                    <tr>
                        <td><strong>PMEGP Subsidy</strong> (Est. Rural Women)</td>
                        <td style="text-align: center;">35%</td>
                        <td class="amount-col currency" id="subsidyAmount">210000</td>
                    </tr>
                    <tr>
                        <td><strong>Bank Loan</strong> (Term Loan)</td>
                        <td style="text-align: center;">60%</td>
                        <td class="amount-col currency" id="bankLoan">360000</td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="2" style="text-align: right;">Total</td>
                        <td class="amount-col currency" id="mofTotal">600000</td>
                    </tr>
                </tbody>
            </table>

            <p style="font-size: 12px; font-style: italic;">* Note: The PMEGP Subsidy is front-ended but kept as a Fixed
                Deposit (TDR) for 3 years, to be adjusted against the loan thereafter.</p>

            <h3 class="section-title">7. Profitability Analysis (Year 1)</h3>

            <table>
                <tr>
                    <td class="label-col">Estimated Annual Production</td>
                    <td><span class="editable" id="prodQty" contenteditable="true">10</span> KG Dry Cordyceps</td>
                </tr>
                <tr>
                    <td class="label-col">Average Selling Price</td>
                    <td><span class="editable" id="unitPrice" contenteditable="true">80000</span> per KG</td>
                </tr>
                <tr style="background-color: #f0f0f0;">
                    <td class="label-col" style="border-top: 2px solid #000;">Total Revenue</td>
                    <td style="font-weight: bold; border-top: 2px solid #000;" class="currency"><span
                            id="totalRevenue">800000</span></td>
                </tr>
                <tr>
                    <td class="label-col">Less: Annual Operating Expenses</td>
                    <td><span class="currency"></span><span class="editable" id="annualExpenses"
                            contenteditable="true">350000</span></td>
                </tr>
                <tr>
                    <td class="label-col">Less: Interest on Loan (@12% approx)</td>
                    <td><span class="currency"></span><span class="editable" id="bankInterest"
                            contenteditable="true">43200</span></td>
                </tr>
                <tr class="total-row">
                    <td class="label-col">Net Profit (Before Tax)</td>
                    <td class="currency"><span id="netProfit">406800</span></td>
                </tr>
            </table>

            <div class="signature-section">
                <div class="signature-box">
                    <div class="signature-line">Signature of Applicant</div>
                    <div>(Mrs. Anjali Sharma)</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line">Date & Place</div>
                </div>
            </div>
        </div>

    </div>

    <script>
        function parseCurrency(str) {
            if (!str) return 0;
            // Remove everything except numbers and decimal point
            return parseFloat(str.replace(/[^0-9.]/g, "")) || 0;
        }

        function formatCurrency(num) {
            return num.toFixed(0);
        }

        function calculateTotals() {
            // 1. Calculate Capital Expenditure
            let totalCapex = 0;
            document.querySelectorAll('.cost-item').forEach(item => {
                totalCapex += parseCurrency(item.innerText);
            });
            document.getElementById('totalCapex').innerText = formatCurrency(totalCapex);

            // 2. Calculate Working Capital
            let totalWC = 0;
            document.querySelectorAll('.wc-item').forEach(item => {
                totalWC += parseCurrency(item.innerText);
            });
            document.getElementById('totalWC').innerText = formatCurrency(totalWC);

            // 3. Grand Total
            let grandTotal = totalCapex + totalWC;
            document.getElementById('grandTotal').innerText = formatCurrency(grandTotal);

            // 4. Update Means of Finance
            let ownContrib = grandTotal * 0.05;
            let subsidy = grandTotal * 0.35; // Assuming 35%
            let bankLoan = grandTotal - ownContrib - subsidy;

            document.getElementById('ownContribution').innerText = formatCurrency(ownContrib);
            document.getElementById('subsidyAmount').innerText = formatCurrency(subsidy);
            document.getElementById('bankLoan').innerText = formatCurrency(bankLoan);
            document.getElementById('mofTotal').innerText = formatCurrency(grandTotal);

            // 5. Update Profitability Analysis
            let prodQty = parseCurrency(document.getElementById('prodQty').innerText);
            let unitPrice = parseCurrency(document.getElementById('unitPrice').innerText);

            let totalRevenue = prodQty * unitPrice;
            document.getElementById('totalRevenue').innerText = formatCurrency(totalRevenue);

            let annualExpenses = parseCurrency(document.getElementById('annualExpenses').innerText);

            // Auto-calculate interest based on Bank Loan (approx 12%)
            // We update the field but allow user to edit it later if they want exact bank figures
            let interest = bankLoan * 0.12;
            document.getElementById('bankInterest').innerText = formatCurrency(interest);

            let netProfit = totalRevenue - annualExpenses - interest;
            document.getElementById('netProfit').innerText = formatCurrency(netProfit);
        }

        document.querySelectorAll('.editable').forEach(item => {
            item.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    this.blur();
                }
            });
        });
    </script>
</body>

</html>